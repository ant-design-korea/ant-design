{"version":3,"sources":["components/table/demo/edit-row.tsx?techStack=react"],"sourcesContent":["import '/home/runner/work/ant-design/ant-design/components/table/demo/edit-row.tsx?watch=parent';import React, { useState } from 'react';\nimport type { TableProps } from 'antd';\nimport { Form, Input, InputNumber, Popconfirm, Table, Typography } from 'antd';\n\ninterface Item {\n  key: string;\n  name: string;\n  age: number;\n  address: string;\n}\n\nconst originData: Item[] = [];\nfor (let i = 0; i < 100; i++) {\n  originData.push({\n    key: i.toString(),\n    name: `Edward ${i}`,\n    age: 32,\n    address: `London Park no. ${i}`,\n  });\n}\ninterface EditableCellProps extends React.HTMLAttributes<HTMLElement> {\n  editing: boolean;\n  dataIndex: string;\n  title: any;\n  inputType: 'number' | 'text';\n  record: Item;\n  index: number;\n}\n\nconst EditableCell: React.FC<React.PropsWithChildren<EditableCellProps>> = ({\n  editing,\n  dataIndex,\n  title,\n  inputType,\n  record,\n  index,\n  children,\n  ...restProps\n}) => {\n  const inputNode = inputType === 'number' ? <InputNumber /> : <Input />;\n\n  return (\n    <td {...restProps}>\n      {editing ? (\n        <Form.Item\n          name={dataIndex}\n          style={{ margin: 0 }}\n          rules={[\n            {\n              required: true,\n              message: `Please Input ${title}!`,\n            },\n          ]}\n        >\n          {inputNode}\n        </Form.Item>\n      ) : (\n        children\n      )}\n    </td>\n  );\n};\n\nconst App: React.FC = () => {\n  const [form] = Form.useForm();\n  const [data, setData] = useState(originData);\n  const [editingKey, setEditingKey] = useState('');\n\n  const isEditing = (record: Item) => record.key === editingKey;\n\n  const edit = (record: Partial<Item> & { key: React.Key }) => {\n    form.setFieldsValue({ name: '', age: '', address: '', ...record });\n    setEditingKey(record.key);\n  };\n\n  const cancel = () => {\n    setEditingKey('');\n  };\n\n  const save = async (key: React.Key) => {\n    try {\n      const row = (await form.validateFields()) as Item;\n\n      const newData = [...data];\n      const index = newData.findIndex((item) => key === item.key);\n      if (index > -1) {\n        const item = newData[index];\n        newData.splice(index, 1, {\n          ...item,\n          ...row,\n        });\n        setData(newData);\n        setEditingKey('');\n      } else {\n        newData.push(row);\n        setData(newData);\n        setEditingKey('');\n      }\n    } catch (errInfo) {\n      console.log('Validate Failed:', errInfo);\n    }\n  };\n\n  const columns = [\n    {\n      title: 'name',\n      dataIndex: 'name',\n      width: '25%',\n      editable: true,\n    },\n    {\n      title: 'age',\n      dataIndex: 'age',\n      width: '15%',\n      editable: true,\n    },\n    {\n      title: 'address',\n      dataIndex: 'address',\n      width: '40%',\n      editable: true,\n    },\n    {\n      title: 'operation',\n      dataIndex: 'operation',\n      render: (_: any, record: Item) => {\n        const editable = isEditing(record);\n        return editable ? (\n          <span>\n            <Typography.Link onClick={() => save(record.key)} style={{ marginInlineEnd: 8 }}>\n              Save\n            </Typography.Link>\n            <Popconfirm title=\"Sure to cancel?\" onConfirm={cancel}>\n              <a>Cancel</a>\n            </Popconfirm>\n          </span>\n        ) : (\n          <Typography.Link disabled={editingKey !== ''} onClick={() => edit(record)}>\n            Edit\n          </Typography.Link>\n        );\n      },\n    },\n  ];\n\n  const mergedColumns: TableProps<Item>['columns'] = columns.map((col) => {\n    if (!col.editable) {\n      return col;\n    }\n    return {\n      ...col,\n      onCell: (record: Item) => ({\n        record,\n        inputType: col.dataIndex === 'age' ? 'number' : 'text',\n        dataIndex: col.dataIndex,\n        title: col.title,\n        editing: isEditing(record),\n      }),\n    };\n  });\n\n  return (\n    <Form form={form} component={false}>\n      <Table\n        components={{\n          body: {\n            cell: EditableCell,\n          },\n        }}\n        bordered\n        dataSource={data}\n        columns={mergedColumns}\n        rowClassName=\"editable-row\"\n        pagination={{\n          onChange: cancel,\n        }}\n      />\n    </Form>\n  );\n};\n\nexport default App;\n"],"names":[],"mappings":"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"}