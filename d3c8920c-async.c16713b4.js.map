{"version":3,"sources":[".dumi/theme/common/BehaviorMap/BehaviorMap.tsx"],"sourcesContent":["import React, { useEffect, useRef } from 'react';\nimport G6 from '@antv/g6';\nimport { createStyles, css } from 'antd-style';\nimport { useRouteMeta } from 'dumi';\n\nG6.registerNode('behavior-start-node', {\n  draw: (cfg, group) => {\n    const textWidth = G6.Util.getTextSize(cfg!.label, 16)[0];\n    const size = [textWidth + 20 * 2, 48];\n    const keyShape = group!.addShape('rect', {\n      name: 'start-node',\n      attrs: {\n        width: size[0],\n        height: size[1],\n        y: -size[1] / 2,\n        radius: 8,\n        fill: '#fff',\n      },\n    });\n    group!.addShape('text', {\n      attrs: {\n        text: `${cfg!.label}`,\n        fill: 'rgba(0, 0, 0, 0.88)',\n        fontSize: 16,\n        fontWeight: 500,\n        x: 20,\n        textBaseline: 'middle',\n      },\n      name: 'start-node-text',\n    });\n    return keyShape;\n  },\n  getAnchorPoints() {\n    return [\n      [0, 0.5],\n      [1, 0.5],\n    ];\n  },\n});\n\nG6.registerNode(\n  'behavior-sub-node',\n  {\n    draw: (cfg, group) => {\n      const textWidth = G6.Util.getTextSize(cfg!.label, 14)[0];\n      const padding = 16;\n      const size = [textWidth + 16 * 2 + (cfg!.targetType ? 12 : 0) + (cfg!.link ? 20 : 0), 40];\n      const keyShape = group!.addShape('rect', {\n        name: 'sub-node',\n        attrs: {\n          width: size[0],\n          height: size[1],\n          y: -size[1] / 2,\n          radius: 8,\n          fill: '#fff',\n          cursor: 'pointer',\n        },\n      });\n      group!.addShape('text', {\n        attrs: {\n          text: `${cfg!.label}`,\n          x: cfg!.targetType ? 12 + 16 : padding,\n          fill: 'rgba(0, 0, 0, 0.88)',\n          fontSize: 14,\n          textBaseline: 'middle',\n          cursor: 'pointer',\n        },\n        name: 'sub-node-text',\n      });\n      if (cfg!.targetType) {\n        group!.addShape('rect', {\n          name: 'sub-node-type',\n          attrs: {\n            width: 8,\n            height: 8,\n            radius: 4,\n            y: -4,\n            x: 12,\n            fill: cfg!.targetType === 'mvp' ? '#1677ff' : '#A0A0A0',\n            cursor: 'pointer',\n          },\n        });\n      }\n      if (cfg!.children) {\n        const { length } = cfg!.children as any;\n        group!.addShape('rect', {\n          name: 'sub-node-children-length',\n          attrs: {\n            width: 20,\n            height: 20,\n            radius: 10,\n            y: -10,\n            x: size[0] - 4,\n            fill: '#404040',\n            cursor: 'pointer',\n          },\n        });\n        group!.addShape('text', {\n          name: 'sub-node-children-length-text',\n          attrs: {\n            text: `${length}`,\n            x: size[0] + 6 - G6.Util.getTextSize(`${length}`, 12)[0] / 2,\n            textBaseline: 'middle',\n            fill: '#fff',\n            fontSize: 12,\n            cursor: 'pointer',\n          },\n        });\n      }\n      if (cfg!.link) {\n        group!.addShape('dom', {\n          attrs: {\n            width: 16,\n            height: 16,\n            x: size[0] - 12 - 16,\n            y: -8,\n            cursor: 'pointer',\n            // DOM's html\n            html: `\n            <div style=\"width: 16px; height: 16px;\">\n              <svg width=\"16px\" height=\"16px\" viewBox=\"0 0 16 16\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n                  <g id=\"页面-1\" stroke=\"none\" stroke-width=\"1\" fill=\"none\" fill-rule=\"evenodd\">\n                      <g id=\"DatePicker\" transform=\"translate(-890.000000, -441.000000)\" fill-rule=\"nonzero\">\n                          <g id=\"编组-30\" transform=\"translate(288.000000, 354.000000)\">\n                              <g id=\"编组-7备份-7\" transform=\"translate(522.000000, 79.000000)\">\n                                  <g id=\"right-circle-outlinedd\" transform=\"translate(80.000000, 8.000000)\">\n                                      <rect id=\"矩形\" fill=\"#000000\" opacity=\"0\" x=\"0\" y=\"0\" width=\"16\" height=\"16\"></rect>\n                                      <path d=\"M10.4171875,7.8984375 L6.5734375,5.1171875 C6.490625,5.0578125 6.375,5.115625 6.375,5.21875 L6.375,5.9515625 C6.375,6.1109375 6.4515625,6.2625 6.58125,6.35625 L8.853125,8 L6.58125,9.64375 C6.4515625,9.7375 6.375,9.8875 6.375,10.0484375 L6.375,10.78125 C6.375,10.8828125 6.490625,10.9421875 6.5734375,10.8828125 L10.4171875,8.1015625 C10.4859375,8.0515625 10.4859375,7.9484375 10.4171875,7.8984375 Z\" id=\"路径\" fill=\"#BFBFBF\"></path>\n                                      <path d=\"M8,1 C4.134375,1 1,4.134375 1,8 C1,11.865625 4.134375,15 8,15 C11.865625,15 15,11.865625 15,8 C15,4.134375 11.865625,1 8,1 Z M8,13.8125 C4.790625,13.8125 2.1875,11.209375 2.1875,8 C2.1875,4.790625 4.790625,2.1875 8,2.1875 C11.209375,2.1875 13.8125,4.790625 13.8125,8 C13.8125,11.209375 11.209375,13.8125 8,13.8125 Z\" id=\"形状\" fill=\"#BFBFBF\"></path>\n                                  </g>\n                              </g>\n                          </g>\n                      </g>\n                  </g>\n              </svg>\n            </div>\n          `,\n          },\n          // 在 G6 3.3 及之后的版本中，必须指定 name，可以是任意字符串，但需要在同一个自定义元素类型中保持唯一性\n          name: 'sub-node-link',\n        });\n      }\n      return keyShape;\n    },\n    getAnchorPoints() {\n      return [\n        [0, 0.5],\n        [1, 0.5],\n      ];\n    },\n    options: {\n      stateStyles: {\n        hover: {\n          stroke: '#1677ff',\n          'sub-node-link': {\n            html: `\n            <div style=\"width: 16px; height: 16px;\">\n              <svg width=\"16px\" height=\"16px\" viewBox=\"0 0 16 16\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n                  <g id=\"页面-1\" stroke=\"none\" stroke-width=\"1\" fill=\"none\" fill-rule=\"evenodd\">\n                      <g id=\"DatePicker\" transform=\"translate(-890.000000, -441.000000)\" fill-rule=\"nonzero\">\n                          <g id=\"编组-30\" transform=\"translate(288.000000, 354.000000)\">\n                              <g id=\"编组-7备份-7\" transform=\"translate(522.000000, 79.000000)\">\n                                  <g id=\"right-circle-outlinedd\" transform=\"translate(80.000000, 8.000000)\">\n                                      <rect id=\"矩形\" fill=\"#000000\" opacity=\"0\" x=\"0\" y=\"0\" width=\"16\" height=\"16\"></rect>\n                                      <path d=\"M10.4171875,7.8984375 L6.5734375,5.1171875 C6.490625,5.0578125 6.375,5.115625 6.375,5.21875 L6.375,5.9515625 C6.375,6.1109375 6.4515625,6.2625 6.58125,6.35625 L8.853125,8 L6.58125,9.64375 C6.4515625,9.7375 6.375,9.8875 6.375,10.0484375 L6.375,10.78125 C6.375,10.8828125 6.490625,10.9421875 6.5734375,10.8828125 L10.4171875,8.1015625 C10.4859375,8.0515625 10.4859375,7.9484375 10.4171875,7.8984375 Z\" id=\"路径\" fill=\"#1677ff\"></path>\n                                      <path d=\"M8,1 C4.134375,1 1,4.134375 1,8 C1,11.865625 4.134375,15 8,15 C11.865625,15 15,11.865625 15,8 C15,4.134375 11.865625,1 8,1 Z M8,13.8125 C4.790625,13.8125 2.1875,11.209375 2.1875,8 C2.1875,4.790625 4.790625,2.1875 8,2.1875 C11.209375,2.1875 13.8125,4.790625 13.8125,8 C13.8125,11.209375 11.209375,13.8125 8,13.8125 Z\" id=\"形状\" fill=\"#1677ff\"></path>\n                                  </g>\n                              </g>\n                          </g>\n                      </g>\n                  </g>\n              </svg>\n            </div>\n          `,\n          },\n        },\n      },\n    },\n  },\n  'rect',\n);\n\nconst dataTransform = (data: BehaviorMapItem) => {\n  const changeData = (d: any, level = 0) => {\n    const clonedData: any = {\n      ...d,\n    };\n    switch (level) {\n      case 0:\n        clonedData.type = 'behavior-start-node';\n        break;\n      case 1:\n        clonedData.type = 'behavior-sub-node';\n        clonedData.collapsed = true;\n        break;\n      default:\n        clonedData.type = 'behavior-sub-node';\n        break;\n    }\n\n    if (d.children) {\n      clonedData.children = d.children.map((child: any) => changeData(child, level + 1));\n    }\n    return clonedData;\n  };\n  return changeData(data);\n};\n\ntype BehaviorMapItem = {\n  id: string;\n  label: string;\n  targetType?: 'mvp' | 'extension';\n  children?: BehaviorMapItem[];\n  link?: string;\n};\n\nconst useStyle = createStyles(({ token }) => ({\n  container: css`\n    width: 100%;\n    height: 600px;\n    background-color: #f5f5f5;\n    border: 1px solid #e8e8e8;\n    border-radius: ${token.borderRadiusLG}px;\n    overflow: hidden;\n    position: relative;\n  `,\n  title: css`\n    position: absolute;\n    top: 20px;\n    inset-inline-start: 20px;\n    font-size: ${token.fontSizeLG}px;\n  `,\n  tips: css`\n    display: flex;\n    position: absolute;\n    bottom: 20px;\n    inset-inline-end: 20px;\n  `,\n  mvp: css`\n    margin-inline-end: ${token.marginMD}px;\n    display: flex;\n    align-items: center;\n    &::before {\n      display: block;\n      width: 8px;\n      height: 8px;\n      margin-inline-end: ${token.marginXS}px;\n      background-color: #1677ff;\n      border-radius: 50%;\n      content: '';\n    }\n  `,\n  extension: css`\n    display: flex;\n    align-items: center;\n    &::before {\n      display: block;\n      width: 8px;\n      height: 8px;\n      margin-inline-end: ${token.marginXS}px;\n      background-color: #a0a0a0;\n      border-radius: 50%;\n      content: '';\n    }\n  `,\n}));\n\nexport type BehaviorMapProps = {\n  data: BehaviorMapItem;\n};\n\nconst BehaviorMap: React.FC<BehaviorMapProps> = ({ data }) => {\n  const ref = useRef<HTMLDivElement>(null);\n  const { styles } = useStyle();\n  const meta = useRouteMeta();\n\n  useEffect(() => {\n    const graph = new G6.TreeGraph({\n      container: ref.current!,\n      width: ref.current!.scrollWidth,\n      height: ref.current!.scrollHeight,\n      renderer: 'svg',\n      modes: {\n        default: ['collapse-expand', 'drag-canvas'],\n      },\n      defaultEdge: {\n        type: 'cubic-horizontal',\n        style: {\n          lineWidth: 1,\n          stroke: '#BFBFBF',\n        },\n      },\n      layout: {\n        type: 'mindmap',\n        direction: 'LR',\n        getHeight: () => 48,\n        getWidth: (node: any) => G6.Util.getTextSize(node.label, 16)[0] + 20 * 2,\n        getVGap: () => 10,\n        getHGap: () => 60,\n        getSide: (node: any) => node.data.direction,\n      },\n    });\n\n    graph.on('node:mouseenter', (e) => {\n      graph.setItemState(e.item!, 'hover', true);\n    });\n    graph.on('node:mouseleave', (e) => {\n      graph.setItemState(e.item!, 'hover', false);\n    });\n    graph.on('node:click', (e) => {\n      const { link } = e.item!.getModel();\n      if (link) {\n        window.location.hash = link as string;\n      }\n    });\n\n    graph.data(dataTransform(data));\n    graph.render();\n    graph.fitCenter();\n  }, []);\n\n  return (\n    <div ref={ref} className={styles.container}>\n      <div className={styles.title}>{`${meta.frontmatter.title} 行为模式地图`}</div>\n      <div className={styles.tips}>\n        <div className={styles.mvp}>MVP 行为目的</div>\n        <div className={styles.extension}>拓展行为目的</div>\n      </div>\n    </div>\n  );\n};\n\nexport default BehaviorMap;\n"],"names":[],"mappings":"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"}